version: '3'
services:
  # supervisor:
  #   image: sinamics/uavcast-supervisor:1.0.1
  #   container_name: supervisor
  #   network_mode: 'host'
  #   restart: always
  #   volumes:
  #     - /var/run/docker.sock:/var/run/docker.sock:ro
  #     - /home/uavcast/uavpipe:/home/uavpipe
  #   privileged: true
  dev:
    container_name: uavcast-dev
    user: uavcast
    privileged: true
    build:
      context: .
      dockerfile: docker/Dockerfile.dev
    restart: always
    volumes:
      - .:/app/uavcast:cached
      - uavdata:/app/uavcast/data
      - /var/lib/zerotier-one:/var/lib/zerotier-one:ro
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - /dev:/dev:ro
    ports:
      - '3000:3000'
      - '80:80'
    depends_on:
      - supervisor
    entrypoint:
      - '/bin/systemctl'
    # command: /bin/sh -c "while sleep 1000; do :; done"
    # tty: true
    # stdin_open: true
volumes:
  uavdata:
